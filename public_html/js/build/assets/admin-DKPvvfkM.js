import{S as L,T as E,a as _}from"./fetch-CIinFdni.js";document.addEventListener("DOMContentLoaded",()=>{y(),h();let e=document.querySelectorAll(".addLine");if(e===null)return!1;e.forEach(t=>{t.addEventListener("click",o=>{o.preventDefault(),g(t.getAttribute("href"),t.getAttribute("data-block"))})})});function g(e,t,o){let a=document.getElementById(t);if(a===null)return!1;let i=new Date().getTime();return e+="/"+i,fetch(e,{method:"GET"}).then(n=>n.text()).then(n=>{a.insertAdjacentHTML("beforeend",n),T(),h(),y(),o&&o(arguments,i)}),!1}function y(){let e=document.querySelectorAll(".removeBlock");if(e===null)return!1;e.forEach(t=>{t.addEventListener("click",o=>{o.preventDefault();let a=t.getAttribute("data-ident"),i=t.getAttribute("data-ordinal"),n=document.querySelector("[data-ident='"+a+"'][data-ordinal='"+i+"']");n!==null&&n.remove()})})}function T(){tinymce.init({selector:"textarea.editor",plugins:["uploadcare","code","image","media","link","preview","lists","table"],toolbar:"undo redo | styles  | bold italic | alignleft aligncenter alignright | indent outdent bullist numlist | table | link image media | code | preview",license_key:"gpl",image_title:!0,automatic_uploads:!0,file_picker_types:"image",file_picker_callback:(e,t,o)=>{const a=document.createElement("input");a.setAttribute("type","file"),a.setAttribute("accept","image/*"),a.addEventListener("change",i=>{const n=i.target.files[0],r=new FileReader;r.addEventListener("load",()=>{const l="blobid"+new Date().getTime(),u=tinymce.activeEditor.editorUpload.blobCache,d=r.result.split(",")[1],s=u.create(l,n,d);u.add(s),e(s.blobUri(),{title:n.name})}),r.readAsDataURL(n)}),a.click()}})}function h(){let e=document.querySelectorAll(".showHideSection");if(e===null)return!1;e.forEach(t=>{t.addEventListener("click",o=>{o.preventDefault(),o.stopImmediatePropagation();let a=t.getAttribute("data-id"),i=document.getElementById(a).querySelector(".wrapper");return i===null||(i.style.maxHeight!=="0px"?i.style.maxHeight="0px":i.style.maxHeight="1000px",console.log(i.style.maxHeight)),!1},!0)})}function A(){return console.log("addStaff"),!1}function x(e){let t=new Date().getTime();return console.log(e.getAttribute("href"),t),!1}function k(e){return document.getElementById(e).remove(),!1}const B=Object.freeze(Object.defineProperty({__proto__:null,RemoveBLock:k,addLine:g,addStaff:A,test:x},Symbol.toStringTag,{value:"Module"}));function q(e,t,o){let a=document.getElementById(e);if(a===null)return!1;a.querySelectorAll("option").forEach(n=>{if(n.value==="")return"";n.getAttribute(t)===o?(n.removeAttribute("disabled"),n.classList.remove("hidden")):(n.setAttribute("disabled","disabled"),n.classList.add("hidden"))}),a.value=""}function O(e,t){if(e=document.getElementById(e),t=document.getElementById(t),e===null||t===null)return!1;let o="/api/departments-by-faculty-shorts/"+e.value;fetch(o,{method:"GET"}).then(a=>a.text()).then(a=>{let i=t.querySelectorAll('option:not([value=""])');i.forEach(n=>n.remove()),i=JSON.parse(a);for(let n in i)t.appendChild(new Option(i[n],n))})}const M=Object.freeze(Object.defineProperty({__proto__:null,DepartmentsByFaculty:O,LimitList:q},Symbol.toStringTag,{value:"Module"}));function j(e){e.closest(".staffBlock").querySelector(".staffID").value=e.dataset.staffId,e.closest(".staffBlock").querySelector(".staffFullName").value=e.dataset.staffFullName}let p=null;function I(e){clearTimeout(p),p=setTimeout(()=>{let t=e.closest(".staffBlock").querySelectorAll(".StaffList li");if(!t)return;let o=e.value.toLowerCase();o===""&&(e.closest(".staffBlock").querySelector(".staffID").value=""),t.forEach(a=>a.classList.toggle("hidden",o!==""&&!a.innerText.toLowerCase().toLowerCase().includes(o))),e.closest(".staffBlock").querySelectorAll(".StaffList li:not(.hidden)").length===0&&(e.closest(".staffBlock").querySelector(".staffID").value="")},250)}const D=Object.freeze(Object.defineProperty({__proto__:null,KeyUp:I,selectStaff:j},Symbol.toStringTag,{value:"Module"}));async function C(e){let t=document.getElementById("adminMessageBox");if(!t)return;let o=t.querySelector(".example").cloneNode(!0);o.querySelector(".message-time").innerText=new Date().toLocaleTimeString(),o.querySelector(".message-content").innerText=e,o.classList.remove("hidden","example"),o.addEventListener("click",()=>ShowMessage.hide(o)),await t.appendChild(o),setTimeout(()=>{o.classList.replace("opacity-0","opacity-100"),o.classList.replace("max-h-0","max-h-60"),o.classList.replace("mt-0","mt-4")},10),setTimeout(()=>S(o),1.1*60*1e3)}async function S(e){e.classList.replace("max-h-60","max-h-0"),e.classList.replace("mt-4","mt-0"),e.classList.replace("opacity-100","opacity-0"),setTimeout(()=>e.destroy,1e3)}const N=Object.freeze(Object.defineProperty({__proto__:null,hide:S,message:C},Symbol.toStringTag,{value:"Module"}));async function P(e,t){await navigator.clipboard.writeText(e),ShowMessage.message(t)}const H=Object.freeze(Object.defineProperty({__proto__:null,copyTextToClipboard:P},Symbol.toStringTag,{value:"Module"}));async function c(e,t="json"){try{let o=await fetch(e,{method:"GET"});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);let a;if(t==="json"){a=await o.text();try{a=JSON.parse(a)}catch(i){return console.error("Error parsing JSON:",i),ShowMessage.message("Ошибка обработки данных."),null}}else a=await o.text();return a&&a.message&&ShowMessage.message(a.message),a}catch(o){return console.error(`Error: ${o}`),ShowMessage.message("Произошла ошибка при выполнении запроса."),null}}async function U(e,t){e.closest("label").classList.add("pointer-events-none");try{await c(t)}catch{}e.closest("label").classList.remove("pointer-events-none")}async function z(e,t){e.classList.add("pointer-events-none");try{await c(t)}catch{}e.classList.add("scale-0"),setTimeout(()=>e.parentNode.removeChild(e),200)}async function b(e,t,o=!1){try{const a=await c(t,"text");a&&e.insertAdjacentHTML("beforeend",a),o&&tinymce.init({selector:"textarea.editor",plugins:["uploadcare","code","image","media","link","preview","lists","table"],toolbar:"undo redo | styles  | bold italic | alignleft aligncenter alignright | indent outdent bullist numlist | table | link image media | code | preview",license_key:"gpl",image_title:!0,automatic_uploads:!0,file_picker_types:"image",file_picker_callback:(i,n,r)=>{const l=document.createElement("input");l.setAttribute("type","file"),l.setAttribute("accept","image/*"),l.addEventListener("change",u=>{const d=u.target.files[0],s=new FileReader;s.addEventListener("load",()=>{const v="blobid"+new Date().getTime(),f=tinymce.activeEditor.editorUpload.blobCache,w=s.result.split(",")[1],m=f.create(v,d,w);f.add(m),i(m.blobUri(),{title:d.name})}),s.readAsDataURL(d)}),l.click()}})}catch(a){console.error("Error in addSection:",a)}}async function R(e,t){console.log(t,e,e.href),e.classList.add("pointer-events-none");try{await c(e.href)}catch{}finally{e.closest(t).parentNode.removeChild(e.closest(t))}}function F(e,t){let o=document.querySelectorAll(t);!e||!o||o.forEach(a=>a.classList.toggle("hidden",a.id!==e))}async function J(e,t,o=!1){e.classList.add("pointer-events-none");try{await c(e.href)}catch{}finally{o?e.closest(t).parentNode.removeChild(e.closest(t)):(e.closest(t).querySelector("input.staffID").value=null,e.closest(t).querySelector("input.staffFullName").value=null,e.classList.remove("pointer-events-none"))}}async function G(e,t){e.classList.add("pointer-events-none");let o=document.getElementById(t);return!o||!e.href?ShowMessage.message("Ошибка обработки данных. Свяжитесь с администратором"):(await b(o,e.href),e.classList.remove("pointer-events-none"),ShowMessage.message("Позиция сотрудника добавлена"))}async function $(e,t){let o=document.getElementById(e);if(!o)return;o.querySelectorAll("option").forEach(i=>{i.value&&i.remove()});let a=await c(t,"collection");a=JSON.parse(a);for(let[i,n]of Object.entries(a)){let r=document.createElement("option");r.value=n.id,r.text=n.name,o.appendChild(r)}}const K=Object.freeze(Object.defineProperty({__proto__:null,DeleteItem:z,DeleteSection:R,ToggleShow:U,VacatePosition:J,addSection:b,addStaffPosition:G,changeSelectOptions:$,showTab:F},Symbol.toStringTag,{value:"Module"}));window.AddLine=B;window.SearchSelect=L;window.DependedSelects=M;window.Tabs=E;window.AdminStaff=D;window.ShowMessage=N;window.ClipBoard=H;window.Service=_;window.Actions=K;
