<section class="slider-section">
    <div class="box-slider sldr">
        <div class="slider sldr">
            <div class="slide_viewer sldr">
                
                <div class="slide_group sldr">
                   {{-- <div class="slide">
                        <a href="https://abiturient.mgu-mlt.ru/" class="slide-link cursor-pointer">
                            <img src="{{asset('img/slider/Platnoe.webp')}}" alt="" class="hidden sm:block w-max">
                            <img src="{{asset('img/slider/Platnoe_mob.webp')}}" alt="" class="block sm:hidden">
                        </a>
                    </div>--}}
                    <div class="slide">
                        <a href="https://max.ru/id9001010985_biz" class="slide-link cursor-pointer" target="_blank">
                            <img src="{{asset('img/slider/MAX_2K.jpg')}}" alt="" class="hidden object-cover min-[1921px]:block w-max">
                            <img src="{{asset('img/slider/MAX_1920.jpg')}}" alt="" class="hidden sm:block">
                            <img src="{{asset('img/slider/MAX_mob.jpg')}}" alt="" class="block sm:hidden">
                        </a>
                    </div>
{{--                    <div class="slide">--}}
{{--                        <a href="https://melsu.ru/tselevoe-obuchenie" class="slide-link cursor-pointer">--}}
{{--                            <img src="{{asset('img/slider/Celevoe_banner.png')}}" alt="" class="hidden sm:block w-max">--}}
{{--                            <img src="{{asset('img/slider/Celevoe_banner_mob.png')}}" alt="" class="block sm:hidden">--}}
{{--                        </a>--}}
{{--                    </div>--}}
{{--                    <div class="slide">--}}
{{--                        <a href="https://abiturient.mgu-mlt.ru/" class="slide-link cursor-pointer">--}}
{{--                            <img src="{{asset('img/Banner_priom_2025.png')}}" alt="" class="hidden sm:block">--}}
{{--                            <img src="{{asset('img/Banner_priom_mob.png')}}" alt="" class="block sm:hidden">--}}
{{--                        </a>--}}
{{--                    </div>--}}
                    <div class="slide">
                        <a href="{{ route('regiment:public:list') }} " class="slide-link cursor-pointer">
                            <img src="{{asset('img/slider/WINNER_2K.jpg')}}" alt="" class="hidden min-[1921px]:block w-max">
                            <img src="{{asset('img/slider/WINNER_1920.jpg')}}" alt="" class="hidden sm:block">
                            <img src="{{asset('img/slider/WINNER_mob.jpg')}}" alt="" class="block sm:hidden">
                        </a>
                    </div>

                    <div class="slide">
                        <a class="slide-link cursor-pointer">
                            <img src="{{asset('img/slider/YEAR_2K.png')}}" alt="" class="hidden min-[1921px]:block w-max">
                            <img src="{{asset('img/slider/YEAR_1920.png')}}" alt="" class="hidden sm:block">
                            <img src="{{asset('img/slider/YEAR_mob.png')}}" alt="" class="block sm:hidden">
                        </a>
                    </div>

                   {{-- <div class="slide">
                        <img src="{{asset('img/Slide.jpg')}}" alt="">
                        <div id="countdown" class="countdown hidden">
                            <div class="countdown-item">
                                <span id="days"></span>
                                <div class="countdown-label">дней</div>
                            </div>
                            <div class="countdown-item">
                                <span id="hours"></span>
                                <div class="countdown-label">часов</div>
                            </div>
                            <div class="countdown-item">
                                <span id="minutes"></span>
                                <div class="countdown-label">минут</div>
                            </div>
                            <div class="countdown-item">
                                <span id="seconds"></span>
                                <div class="countdown-label">секунд</div>
                            </div>
                        </div>
                    </div> --}}
                </div>
            </div>
        </div>

        <div class="slide_buttons sldr">
        </div>
    </div>
    <div class="info-under-slider card-black-glass border-t border-l-0 border-r-0 border-b-0 border-white" style="backdrop-filter: blur(5px) saturate(100%) !important;">
        <div class="previous_btn group flex items-center cursor-pointer" title="Previous">
            <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M49 25C49 11.7452 38.2548 1 25 0.999999C11.7452 0.999998 1.00001 11.7452 1 25C1 38.2548 11.7452 49 25 49C38.2548 49 49 38.2548 49 25Z" stroke="#EEEEEE" class="group-hover:stroke-[#EEEEEE] transition duration-300 ease-linear" stroke-width="2"/>
                <path d="M13 4.21539C9.35154 6.32183 6.32183 9.35154 4.21539 13C2.10895 16.6485 1 20.7871 1 25C1 29.2129 2.10895 33.3515 4.21539 37C6.32183 40.6485 9.35154 43.6782 13 45.7846" stroke="#252422" class="group-hover:stroke-[#EEEEEE] transition duration-300 ease-linear" stroke-width="2"/>
                <path d="M29.5 34.5L20.3125 25L29.5 15.5" stroke="#EEEEEE" class="group-hover:stroke-[#EEEEEE] transition duration-300 ease-linear" stroke-width="2"/>
            </svg>
        </div>
        <div class="slider-container">
            <div class="slider-wrapper">
                <div class="box-info-under-slider">
                    <a href="https://melsu.ru/rcfg" class="under-info group border-[#FFFFFF] border-r-0 border-t-0 border-b-0 border-l-0 flex flex-col gap-2 justify-between">
                        <span class="text-under-info font-semibold">Региональный центр финансовой грамотности "Запорожье"</span>
                        <div class="ico-link flex justify-end absolute right-2.5 bottom-2.5 2xl:right-5 2xl:bottom-5 group-hover:-translate-y-1 transform duration-300 ease-linear">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3.66667 1H17M17 1V14.3333M17 1L1 17" stroke="white" class="stroke-1 2xl:stroke-2"/>
                            </svg>
                        </div>
                    </a>
                </div>
                <div class="box-info-under-slider">
                    <a href="https://melsu.ru/conference-of-workers-and-students-2025" class="under-info group border-[#FFFFFF] border-r-0 border-t-0 border-b-0 border-l-0 flex flex-col gap-2 justify-between">
                        <span class="text-under-info font-semibold">Конференция работников и обучающихся 2025</span>
                        <div class="ico-link flex justify-end absolute right-2.5 bottom-2.5 2xl:right-5 2xl:bottom-5 group-hover:-translate-y-1 transform duration-300 ease-linear">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3.66667 1H17M17 1V14.3333M17 1L1 17" stroke="white" class="stroke-1 2xl:stroke-2"/>
                            </svg>
                        </div>
                    </a>
                </div>
            {{-- <div class="box-info-under-slider">
                    <a href="https://abiturient.mgu-mlt.ru/documents" class="under-info group border-[#FFFFFF] border-r border-t-0 border-b-0 border-l-0 flex flex-col gap-2 justify-between">
                        <span class="text-under-info font-semibold">Приказы о зачислении</span>
                        <div class="ico-link flex justify-end absolute right-2.5 bottom-2.5 2xl:right-5 2xl:bottom-5 group-hover:-translate-y-1 transform duration-300 ease-linear">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3.66667 1H17M17 1V14.3333M17 1L1 17" stroke="white" class="stroke-1 2xl:stroke-2"/>
                            </svg>
                        </div>
                    </a>
                </div>
                
                <div class="box-info-under-slider">
                    <a href="https://abiturient.mgu-mlt.ru/competition-lists" class="under-info group border-[#FFFFFF] border-r border-t-0 border-b-0 border-l-0 flex flex-col gap-2 justify-between">
                        <span class="text-under-info font-semibold">Конкурсные списки поступающих</span>
                        <div class="ico-link flex justify-end absolute right-2.5 bottom-2.5 2xl:right-5 2xl:bottom-5 group-hover:-translate-y-1 transform duration-300 ease-linear">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3.66667 1H17M17 1V14.3333M17 1L1 17" stroke="white" class="stroke-1 2xl:stroke-2"/>
                            </svg>
                        </div>
                    </a>
                </div> --}}
                <div class="box-info-under-slider">
                    <a href="{{url('programma-razvitiya-melsu')}}" class="under-info group border-[#FFFFFF] border-r-0 border-t-0 border-b-0 border-l-0 flex flex-col gap-2 justify-between">
                        <span class="text-under-info font-semibold">Программа развития МелГУ на 2023-2028 годы</span>
                        <div class="ico-link flex justify-end absolute right-2.5 bottom-2.5 2xl:right-5 2xl:bottom-5 group-hover:-translate-y-1 transform duration-300 ease-linear">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3.66667 1H17M17 1V14.3333M17 1L1 17" stroke="white" class="stroke-1 2xl:stroke-2"/>
                            </svg>
                        </div>
                    </a>
                </div>
                <div class="box-info-under-slider">
                    <a href="{{ route('clusters.list') }}" class="under-info group border-[#FFFFFF] border-r-0 border-t-0 border-b-0 border-l-0 flex flex-col gap-2 justify-between">
                        <span class="text-under-info font-semibold">Флагманские проекты</span>
                        <div class="ico-link flex justify-end absolute right-2.5 bottom-2.5 2xl:right-5 2xl:bottom-5 group-hover:-translate-y-1 transform duration-300 ease-linear">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3.66667 1H17M17 1V14.3333M17 1L1 17" stroke="white" class="stroke-1 2xl:stroke-2"/>
                            </svg>
                        </div>
                    </a>
                </div>
                <div class="box-info-under-slider">
                    <a href="{{ url('selekcionno-semenovodcheskij-centr-vysokotekhnologichnyj-selekcionno-pitomnikovodcheskij-kompleks-plodovyh-kultur-novorossii') }}" class="under-info group border-[#FFFFFF] border-r-0 border-t-0 border-b-0 border-l-0 flex flex-col gap-2 justify-between">
                        <span class="text-under-info font-semibold text-wrap">Селекционно-семеноводческий центр</span>
                        <div class="ico-link flex justify-end absolute right-2.5 bottom-2.5 2xl:right-5 2xl:bottom-5 group-hover:-translate-y-1 transform duration-300 ease-linear">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3.66667 1H17M17 1V14.3333M17 1L1 17" stroke="white" class="stroke-1 2xl:stroke-2"/>
                            </svg>
                        </div>
                    </a>
                </div>
                
            </div>
        </div>
        <div class="next_btn group flex items-center cursor-pointer" title="Next">
            <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M1 25C1 11.7452 11.7452 1 25 0.999999C38.2548 0.999998 49 11.7452 49 25C49 38.2548 38.2548 49 25 49C11.7452 49 1 38.2548 1 25Z" stroke="#EEEEEE" class="group-hover:stroke-[#EEEEEE] transition duration-300 ease-linear" stroke-width="2"/>
                <path d="M37 4.21539C40.6485 6.32183 43.6782 9.35154 45.7846 13C47.8911 16.6485 49 20.7871 49 25C49 29.2129 47.8911 33.3515 45.7846 37C43.6782 40.6485 40.6485 43.6782 37 45.7846" stroke="#252422" class="group-hover:stroke-[#EEEEEE] transition duration-300 ease-linear" stroke-width="2"/>
                <path d="M20.5 34.5L29.6875 25L20.5 15.5" stroke="#EEEEEE" class="group-hover:stroke-[#EEEEEE] transition duration-300 ease-linear" stroke-width="2"/>
            </svg>
        </div>
        <div class="slider-button prev hidden" title="Previous">
            <i class="bi bi-chevron-left"></i>
        </div>
        <div class="slider-button next hidden" title="Next">
            <i class="bi bi-chevron-right"></i>
        </div>
    </div>
</section>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const sliderWrapper = document.querySelector('.slider-wrapper');
        const slides = document.querySelectorAll('.box-info-under-slider');
        const prevBtn = document.querySelector('.previous_btn'); 
        const nextBtn = document.querySelector('.next_btn');

        const settings = {
            slideDuration: 500,
            autoSlideInterval: 5000,
            firstAutoSlideInterval: 8000,
            swipeThreshold: 0.2,
            maxDragSlides: 2
        };

        const state = {
            currentIndex: 1,
            isDragging: false,
            isAnimating: false,
            startX: 0,
            currentX: 0,
            dragOffset: 0,
            slideInterval: null,
            allSlides: null,
            visibleSlides: 3,
            isScrolling: false
        };

        function updateVisibleSlides() {
            state.visibleSlides = window.innerWidth > 640 ? 3 : 1;
        }
        
        function initSlider() {
            document.querySelectorAll('.clone').forEach(clone => clone.remove());
            
            updateVisibleSlides();

            const originalSlides = Array.from(document.querySelectorAll('.box-info-under-slider:not(.clone)'));
            const slideCount = originalSlides.length;

            for (let i = 0; i < state.visibleSlides; i++) {
                const firstClone = originalSlides[i].cloneNode(true);
                const lastClone = originalSlides[slideCount - 1 - i].cloneNode(true);
                
                firstClone.classList.add('clone');
                lastClone.classList.add('clone');
                
                sliderWrapper.appendChild(firstClone);
                sliderWrapper.insertBefore(lastClone, originalSlides[0]);
            }

            state.allSlides = document.querySelectorAll('.box-info-under-slider');

            state.currentIndex = state.visibleSlides;
            setSlidePosition(state.currentIndex, false);

            addEventListeners();
            startAutoSlide();
        }

        function setSlidePosition(index, animate = true) {
            sliderWrapper.style.transition = animate ?
                `transform ${settings.slideDuration}ms ease-in-out` : 'none';
            
            const slideWidthPercent = 100 / state.visibleSlides;
            sliderWrapper.style.transform = `translateX(${-index * slideWidthPercent}%)`;
        }

        function goToSlide(index, animate = true) {
            if (state.isAnimating) return;

            const slideCount = state.allSlides.length - 2 * state.visibleSlides; 
            const maxIndex = slideCount + state.visibleSlides;

            let newIndex = index;

            state.isAnimating = true;
            setSlidePosition(newIndex, animate);

            setTimeout(function() {
                if (newIndex <= state.visibleSlides - 1) {
                    state.currentIndex = slideCount + newIndex;
                    setSlidePosition(state.currentIndex, false);
                } else if (newIndex >= maxIndex) {
                    state.currentIndex = newIndex - slideCount;
                    setSlidePosition(state.currentIndex, false);
                } else {
                    state.currentIndex = newIndex;
                }
                
                if (newIndex === 0) {
                    state.currentIndex = slideCount;
                    setSlidePosition(state.currentIndex, false);
                } else if (newIndex === state.allSlides.length - 1) {
                     state.currentIndex = 1;
                     setSlidePosition(state.currentIndex, false);
                }
                
                if (state.currentIndex < state.visibleSlides) {
                    state.currentIndex = state.visibleSlides;
                } else if (state.currentIndex > slideCount + state.visibleSlides - 1) {
                    state.currentIndex = state.visibleSlides;
                }
                
                setTimeout(function() {
                    state.isAnimating = false;
                }, 20);
            }, animate ? settings.slideDuration : 0);
        }

        function startAutoSlide() {
            stopAutoSlide();

            state.slideInterval = setInterval(function() {
                if (!state.isDragging && !state.isAnimating) {
                    goToSlide(state.currentIndex + 1);
                }
            }, settings.autoSlideInterval);
        }

        function stopAutoSlide() {
            clearInterval(state.slideInterval);
        }

        function resetAutoSlide() {
            stopAutoSlide();
            setTimeout(startAutoSlide, settings.slideDuration + 100);
        }
        
        function handleResize() {
            const newVisibleSlides = window.innerWidth > 640 ? 3 : 1;
            
            if (newVisibleSlides !== state.visibleSlides) {
                initSlider(); 
            } else {
                setSlidePosition(state.currentIndex, false);
            }
        }

        function handleDragStart(e) {
            if (state.isAnimating) return;
            state.isScrolling = false;
            if (e.type === 'mousedown') {
                e.preventDefault(); 
            }
            state.isDragging = true;
            state.startX = e.clientX || e.touches[0].clientX;
            state.currentX = state.startX;
            sliderWrapper.style.transition = 'none';
            sliderWrapper.style.cursor = 'grabbing';
            stopAutoSlide();
        }

        function handleDragMove(e) {
            if (!state.isDragging) return;

            const x = e.clientX || e.touches[0].clientX;
            const walk = x - state.startX;

            if (Math.abs(walk) > 5) {
                state.isScrolling = true;
            }
            
            state.currentX = e.clientX || e.touches[0].clientX;
            state.dragOffset = state.currentX - state.startX;
            
            const slideWidthPercent = 100 / state.visibleSlides;
            const currentPosition = -state.currentIndex * slideWidthPercent;
            
            const limitedOffset = state.dragOffset * 0.7;
            const dragPercent = limitedOffset / sliderWrapper.offsetWidth * 100;
            const position = currentPosition + dragPercent;

            sliderWrapper.style.transform = `translateX(${position}%)`;
        }

        function handleDragEnd() {
            if (!state.isDragging) return;
            state.isDragging = false;
            sliderWrapper.style.cursor = 'grab';

            const swipeDistance = Math.abs(state.dragOffset);
            const slideWidth = sliderWrapper.offsetWidth / state.visibleSlides;
            
            if (swipeDistance > slideWidth * settings.swipeThreshold) {
                let slidesToMove = Math.round(swipeDistance / slideWidth);
                slidesToMove = Math.min(slidesToMove, settings.maxDragSlides);

                const direction = state.dragOffset > 0 ? -1 : 1;
                goToSlide(state.currentIndex + (direction * slidesToMove));
            } else {
                goToSlide(state.currentIndex);
            }

            resetAutoSlide();
            state.dragOffset = 0;
        }

        function addEventListeners() {
            // Мышь
            sliderWrapper.addEventListener('mousedown', handleDragStart);
            document.addEventListener('mousemove', handleDragMove);
            document.addEventListener('mouseup', handleDragEnd);

            // Тач
            sliderWrapper.addEventListener('touchstart', handleDragStart, { passive: true });
            document.addEventListener('touchmove', handleDragMove, { passive: true });
            document.addEventListener('touchend', handleDragEnd);

            // Кнопки
           /* prevBtn.addEventListener('click', function() {
                goToSlide(state.currentIndex - 1);
                resetAutoSlide();
            });

            nextBtn.addEventListener('click', function() {
                goToSlide(state.currentIndex + 1);
                resetAutoSlide();
            });*/

            const links = sliderWrapper.querySelectorAll('a');
            links.forEach(link => {
                link.addEventListener('click', function(e) {
                    if (state.isScrolling) {
                        e.preventDefault();
                    }
                });
            });

            sliderWrapper.addEventListener('mouseenter', stopAutoSlide);
            sliderWrapper.addEventListener('mouseleave', startAutoSlide);
            
            window.addEventListener('resize', handleResize);
        }

        initSlider();
    });
</script>
